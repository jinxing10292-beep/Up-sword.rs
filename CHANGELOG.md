# 업데이트 내역

## 2025-02-10 주요 업데이트

### 1. 환전소 구현 ✅
- **새 페이지**: `exchange.html`
- **기능**:
  - 머니(M) → 골드(G) 환전 (1M = 1,500G)
  - 일일 환전 한도: 1,000,000G
  - 최소 환전: 1M, 최대 환전: 667M
  - 실시간 환전 계산기
  - 빠른 금액 선택 버튼 (10M, 50M, 100M, 최대)
  - 환전 내역 조회
- **UI**: 반응형 디자인, 직관적인 인터페이스

### 2. 히든검 영속성 수정 ✅
- **DB 스키마**: `add-hidden-sword-persistence.sql`
  - `user_swords` 테이블에 `is_hidden` 컬럼 추가
  - `hidden_expires_at` 컬럼 추가 (만료 시간 관리)
  - 인덱스 추가로 성능 최적화
  - 자동 만료 체크 트리거 함수
- **코드 수정**: `sword.html`
  - 히든검 획득 시 `user_swords` 테이블에 자동 저장
  - 도감에 영구 보관
  - 히든검 정보를 `sword_names.json`에서 가져와 저장

### 3. 배틀 시스템 개선 ✅
- **회피 시스템**:
  - 플레이어 회피율: 5% + (배틀 레벨 × 0.5%) (최대 15%)
  - 회피 성공 시 데미지 무효화
  - 회피 로그 메시지 추가
- **크리티컬 시스템**:
  - 크리티컬 확률: 8% + (검 레벨 × 1%) (최대 25%)
  - 크리티컬 데미지: 기본 데미지 × 1.5배
  - 크리티컬 히트 시각 효과 및 로그
- **PvP 배틀**:
  - 양측 모두 회피 및 크리티컬 적용
  - 상대방 스탯 기반 확률 계산

### 4. 미니게임 반응형 개선 ✅
- **CSS 파일**: `minigame-responsive.css`
- **개선 사항**:
  - 태블릿 (768px 이하) 최적화
  - 모바일 (600px 이하) 최적화
  - 작은 모바일 (400px 이하) 최적화
  - 가로 모드 최적화
  - 터치 디바이스 최적화 (최소 터치 영역 44px)
  - 배틀 시스템 반응형 레이아웃
  - 주식/룰렛 게임 반응형 개선
  - iOS 권장 터치 영역 준수

### 5. 룰렛/주식 이펙트 개선 ✅
- **룰렛 애니메이션**:
  - 회전 시 발광 효과 (box-shadow 애니메이션)
  - 결과 표시 페이드인 애니메이션
  - 당첨 번호 펄스 애니메이션
  - 색상별 발광 효과 (빨강/검정/초록)
- **주식 카드 효과**:
  - 호버 시 그라데이션 오버레이
  - 부드러운 전환 효과
  - 그림자 강화

### 6. 도감 버그 수정 ✅
- **수정 내역**:
  - `sword_names.json` 로드 실패 시 에러 처리 개선
  - `user_swords` 조회 실패 시 안전한 폴백
  - null/undefined 검 ID 필터링
  - 에러 메시지 상세화

### 7. 균형잡기 Pro 삭제 ✅
- **변경 사항**:
  - `minigames.html`에서 균형잡기 게임 카드 제거
  - 게임 그리드 레이아웃 재정렬
  - 4개 게임으로 축소 (공룡, 주식, 테트리스, 블랙잭)

## 기술 스택
- Frontend: HTML5, CSS3, JavaScript
- Backend: Supabase (PostgreSQL)
- 스타일: Pretendard 폰트, Font Awesome 아이콘

## 호환성
- 모든 모던 브라우저 지원
- 모바일/태블릿 반응형 지원
- iOS/Android 터치 최적화

## 다음 업데이트 예정
- 환전 내역 DB 저장 및 조회
- 히든검 만료 시스템 활성화
- 배틀 리플레이 기능
- 추가 미니게임
